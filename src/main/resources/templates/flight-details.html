<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Page Title</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
	crossorigin="anonymous">
<script
	src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
	integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
	crossorigin="anonymous"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
	integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
	crossorigin="anonymous"></script>
<link href="/css/body.css" rel="stylesheet">
<link href="/css/navbar.css" rel="stylesheet">
<link href="/css/flight-details.css" rel="stylesheet">
<link href="/css/flights.css" rel="stylesheet">
</head>
<body>
	<nav th:replace="~{fragments :: navbar}"></nav>
	
	<div class="form">
<div class="alert alert-danger alert-dismissible fade show w-100" id="errorAlert" role="alert" th:if="${booked} != null and ${booked} == 'false'" >
	 <span th:text="#{flight.booking.error}"></span>
  	<a class="close" href="#" data-bs-dismiss="alert" aria-label="Close" id="hideAlertButton">
    	<span aria-hidden="true">&times;</span>
 	</a>
</div>
<div class="alert alert-danger alert-dismissible fade show w-100" id="errorAlert" role="alert" th:if="${actionStatus} != null and ${actionStatus} == 'deleteError'" >
	 <span th:text="#{flight.delete.error}"></span>
  	<a class="close" href="#" data-bs-dismiss="alert" aria-label="Close" id="hideAlertButton">
    	<span aria-hidden="true">&times;</span>
 	</a>
</div>
<div class="alert alert-danger alert-dismissible fade show w-100" id="errorAlert" role="alert" th:if="${actionStatus} != null and ${actionStatus} == 'addToCartError'" >
	 <span th:text="#{flight.add.to.cart.error}"></span>
  	<a class="close" href="#" data-bs-dismiss="alert" aria-label="Close" id="hideAlertButton">
    	<span aria-hidden="true">&times;</span>
 	</a>
</div>
<div class="flightDetails" th:if="${flight} != null">
			<div class="flightDataDiv">
				<div class="d-flex flex-row flex-wrap">
				<div class="imageDiv">
					<img src="/images/flight-pic.jpg" id="flightImage">
				</div>
				<div class="headerDiv">
					<h1 th:text="${flight.departure.code} + '-' + ${flight.destination.code}"></h1>
					<span><span th:text="#{flight.departure.lbl}"></span><a th:href="@{/airport/details?id={airportId}(airportId=${flight.departure.id})}" th:text="'  ' + ${flight.departure.code}"></a><span th:text="'/'"></span><a th:href="@{/location/details?id={locationId}(locationId=${flight.departure.location.id})}" th:text="${flight.departure.location.city}"></a></span>
					<span><span th:text="#{flight.destination.lbl}"></span><a th:href="@{/airport/details?id={airportId}(airportId=${flight.destination.id})}" th:text="'  ' + ${flight.destination.code}"></a><span th:text="'/'"></span><a th:href="@{/location/details?id={locationId}(locationId=${flight.destination.location.id})}" th:text="${flight.destination.location.city}"></a></span>
					<span><span th:text="#{flight.departureDate.lbl}"></span><span th:text="' ' + ${flight.dateOfDeparture}"></span></span>
					<span><span th:text="#{flight.departureTime.lbl}"></span><span th:text="' ' + ${flight.timeOfDeparture}"></span></span>
					<span><span th:text="#{flight.flightDuration.lbl}"></span><span th:text="' ' + ${flight.duration} + ' min.'"></span></span>
					<span><span th:text="#{flight.airplane.lbl}"></span><a th:href="@{/airplane/details?id={airplaneId}(airplaneId=${flight.airplane.id})}" th:text="' ' + ${flight.airplane.name}"></a></span>
					
					<div class="actionDiv">
						<input type="hidden" th:value="${flight.id}" id="flightIdField">
						<input type="hidden" th:value="${session.loggedIn} == null ? 0 : 1" id="logged-in"> 
						<a th:if="${session.loggedIn} != null and ${session.loggedIn.Role.name()} == 'Admin'" class="btn btn-danger" th:href="@{/flight/delete?id={flightId}(flightId=${flight.id})}" role="button" th:text="#{delete.btn}"></a>
						<a th:if="${session.loggedIn} != null and ${session.loggedIn.Role.name()} == 'Admin'" class="btn btn-dark" href="#" role="button" th:text="#{edit.btn}"></a>
						<a th:if="${session.loggedIn} != null and ${session.loggedIn.Role.name()} == 'Admin'" class="btn btn-dark" th:href="@{/flight/cancel?id={flightId}(flightId=${flight.id})}" role="button" th:text="#{cancel.btn}"></a>
						<button class="btn btn-dark" id="add-to-cart-btn" th:text="#{book.btn}"></button>
<!--						<form action="/flight/book" method="POST" th:if="(${session.loggedIn} != null and ${session.loggedIn.Role.name()} == 'Tourist') or ${session.loggedIn} == null" class="flightReservationForm">
							<span class="mt-5" th:text="#{tickets.no}"></span><br>
							<input type="hidden" th:value="${flight.id}" name="flightId">
							<input type="number" th:if="${session.numberOfTickets != null}" min="0" max="10" class="mb-3" required name="numberOfTickets" th:value="${session.numberOfTickets}">
							<input type="number" th:unless="${session.numberOfTickets != null}" min="0" max="10" class="mb-3" required name="numberOfTickets" value="1"><br>
							<button class="btn btn-dark" type="submit" role="button" th:text="#{book.btn}"></button>
						</form>  -->
					</div>
				</div>
				</div>
				<div class="airplane-container">
				  <div class="airplane-shape">
				    <div class="d-flex flex-row" id="airplane-seats">
				      <div th:each="i : ${#numbers.sequence(1, flight.airplane.numberOfColumns)}">
				        <div th:each="j : ${#numbers.sequence(1, flight.airplane.numberOfRows)}">
				          <button th:attr="data-column=${i}, data-row=${j}" class="seat available" th:if="${seats[i - 1][j - 1]} == 0">
				          </button>
				    	  <button class="seat occupied" th:if="${seats[i - 1][j - 1]} != 0" disabled>
				          </button>
				        </div>
				      </div>
				    </div>
				  </div>
				</div>
				<div></div>
			</div>
		</div>

		<div th:unless="${flight} != null">
			<p th:text="#{flight.not.found.msg}"></p>
			<a href="/flight/" th:text="#{flight.show.all.link}"></a>
		</div>
	</div>
	<script src="/js/flight-details.js"></script>
</body>
</html>